{"filter":false,"title":"Projectile.js","tooltip":"/client/script/Projectile.js","undoManager":{"mark":87,"position":87,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":138,"column":18},"action":"insert","lines":["var Ship = (function(INHERITS_FROM) {","  function Ship(options) {","    options.type = window.SPRITE_TYPES.SHIP;","    options.isBoundToLayer = true;","    !options.id && (options.id = 'ship_' + Date.now());","    !options.width && (options.width = 50);","    !options.height && (options.height = 50);","    ","    INHERITS_FROM && INHERITS_FROM.call(this, options);","","    this.meta = {};","    this.skills = {};","    ","    this.isPlayer = false;","","    this.init(options);","  }","  ","  if (INHERITS_FROM) {","    Ship.prototype = Object.create(INHERITS_FROM.prototype);","    Ship.prototype.constructor = Ship;","  }","","  Ship.prototype.init = function init(options) {","    !options && (options = {});","","    if (!options.id) {","      throw new Error('No ship id provided!', options);","    }","    ","    INHERITS_FROM && INHERITS_FROM.prototype.init.apply(this, arguments);","","    this.isPlayer = Boolean(options.isPlayer);","","    this.elName = document.createElement('span');","    this.elName.className = 'name';","","    this.el.appendChild(this.elName);","    ","    console.warn('[Ship|' + this.id + '] Create', this);","  };","  ","  Ship.prototype.destroy = function destroy() {","    INHERITS_FROM && INHERITS_FROM.prototype.destroy.apply(this, arguments);","    ","    for (var id in this.skills) {","      delete this.skills[id];","    }","  };","  ","  Ship.prototype.addSkill = function addSkill(skill) {","    if (this.skills[skill.id]) {","      return;","    }","    ","    this.skills[skill.id] = skill;","  };","  ","  Ship.prototype.update_name = function update_name() {","    this.elName.innerHTML = this.meta.name.replace(/</g, '&lt;');","  };","","  Ship.prototype.update_shipId = function update_shipId() {","    this.setImage('/images/ships/' + this.meta.shipId + '.png');","  };","  ","  Ship.prototype.update = function update(dt) {","    INHERITS_FROM && INHERITS_FROM.prototype.update.apply(this, arguments);","    ","    for (var skillId in this.skills) {","      this.skills[skillId].update(dt);","    }","  };","","  Ship.prototype.update_team = function update_team() {","    var classList = this.el.classList;","","    if (this.isPlayer) {","      classList.add('self');","    } else {","      if (window.PLAYER.meta.team === this.meta.team) {","        classList.add('ally');","        classList.remove('enemy');","      } else {","        classList.add('enemy');","        classList.remove('ally');","      }","    }","  };","","  Ship.prototype.moveTo = function moveTo(x, y) {","    this.position.x = x;","    this.position.y = y;","  };","  ","  Ship.prototype.toMetaData = function toMetaData() {","    return this.meta;","  };","  ","  Ship.prototype.toTickData = function toTickData() {","    return {","      'x': this.position.x,","      'y': this.position.y,","      'angle': this.angle,","      'velocity': this.velocity.toTickData()","    };","  };","  ","  Ship.prototype.fromMetaData = function fromMetaData(data) {","    for (var k in data) {","      if (this.meta[k] === data[k]) {","        continue;","      }","","      this.meta[k] = data[k];","      ","      if (this['update_' + k]) {","        this['update_' + k]();","      }","    }","  };","  ","  Ship.prototype.fromTickData = function fromTickData(data) {","    this.position.x = data.x;","    this.position.y = data.y;","    this.angle = data.angle;","  };","  ","  Ship.prototype.fromServer = function fromServer(data) {","    var skills = data.skills || {};","    for (var id in skills) {","      if (this.skills[id]) {","        this.skills[id].fromServer(skills[id]);","      }","    }","  };","","  return Ship;","}(window.Sprite));"]}]}],[{"group":"doc","deltas":[{"start":{"row":40,"column":4},"end":{"row":135,"column":4},"action":"remove","lines":["","  ","  Ship.prototype.destroy = function destroy() {","    INHERITS_FROM && INHERITS_FROM.prototype.destroy.apply(this, arguments);","    ","    for (var id in this.skills) {","      delete this.skills[id];","    }","  };","  ","  Ship.prototype.addSkill = function addSkill(skill) {","    if (this.skills[skill.id]) {","      return;","    }","    ","    this.skills[skill.id] = skill;","  };","  ","  Ship.prototype.update_name = function update_name() {","    this.elName.innerHTML = this.meta.name.replace(/</g, '&lt;');","  };","","  Ship.prototype.update_shipId = function update_shipId() {","    this.setImage('/images/ships/' + this.meta.shipId + '.png');","  };","  ","  Ship.prototype.update = function update(dt) {","    INHERITS_FROM && INHERITS_FROM.prototype.update.apply(this, arguments);","    ","    for (var skillId in this.skills) {","      this.skills[skillId].update(dt);","    }","  };","","  Ship.prototype.update_team = function update_team() {","    var classList = this.el.classList;","","    if (this.isPlayer) {","      classList.add('self');","    } else {","      if (window.PLAYER.meta.team === this.meta.team) {","        classList.add('ally');","        classList.remove('enemy');","      } else {","        classList.add('enemy');","        classList.remove('ally');","      }","    }","  };","","  Ship.prototype.moveTo = function moveTo(x, y) {","    this.position.x = x;","    this.position.y = y;","  };","  ","  Ship.prototype.toMetaData = function toMetaData() {","    return this.meta;","  };","  ","  Ship.prototype.toTickData = function toTickData() {","    return {","      'x': this.position.x,","      'y': this.position.y,","      'angle': this.angle,","      'velocity': this.velocity.toTickData()","    };","  };","  ","  Ship.prototype.fromMetaData = function fromMetaData(data) {","    for (var k in data) {","      if (this.meta[k] === data[k]) {","        continue;","      }","","      this.meta[k] = data[k];","      ","      if (this['update_' + k]) {","        this['update_' + k]();","      }","    }","  };","  ","  Ship.prototype.fromTickData = function fromTickData(data) {","    this.position.x = data.x;","    this.position.y = data.y;","    this.angle = data.angle;","  };","  ","  Ship.prototype.fromServer = function fromServer(data) {","    var skills = data.skills || {};","    for (var id in skills) {","      if (this.skills[id]) {","        this.skills[id].fromServer(skills[id]);","      }","    }","  };"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":19},"end":{"row":39,"column":23},"action":"remove","lines":["Ship"]},{"start":{"row":39,"column":19},"end":{"row":39,"column":20},"action":"insert","lines":["P"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":20},"end":{"row":39,"column":21},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":21},"end":{"row":39,"column":22},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":22},"end":{"row":39,"column":23},"action":"insert","lines":["j"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":23},"end":{"row":39,"column":24},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":24},"end":{"row":39,"column":25},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":25},"end":{"row":39,"column":26},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":26},"end":{"row":39,"column":27},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":27},"end":{"row":39,"column":28},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":39,"column":28},"end":{"row":39,"column":29},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":42,"column":9},"end":{"row":42,"column":13},"action":"remove","lines":["Ship"]},{"start":{"row":42,"column":9},"end":{"row":42,"column":19},"action":"insert","lines":["Projectile"]}]}],[{"group":"doc","deltas":[{"start":{"row":0,"column":4},"end":{"row":0,"column":8},"action":"remove","lines":["Ship"]},{"start":{"row":0,"column":4},"end":{"row":0,"column":14},"action":"insert","lines":["Projectile"]}]}],[{"group":"doc","deltas":[{"start":{"row":1,"column":11},"end":{"row":1,"column":15},"action":"remove","lines":["Ship"]},{"start":{"row":1,"column":11},"end":{"row":1,"column":21},"action":"insert","lines":["Projectile"]}]}],[{"group":"doc","deltas":[{"start":{"row":19,"column":4},"end":{"row":19,"column":8},"action":"remove","lines":["Ship"]},{"start":{"row":19,"column":4},"end":{"row":19,"column":14},"action":"insert","lines":["Projectile"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":4},"end":{"row":20,"column":8},"action":"remove","lines":["Ship"]},{"start":{"row":20,"column":4},"end":{"row":20,"column":14},"action":"insert","lines":["Projectile"]}]}],[{"group":"doc","deltas":[{"start":{"row":23,"column":2},"end":{"row":23,"column":6},"action":"remove","lines":["Ship"]},{"start":{"row":23,"column":2},"end":{"row":23,"column":12},"action":"insert","lines":["Projectile"]}]}],[{"group":"doc","deltas":[{"start":{"row":20,"column":39},"end":{"row":20,"column":43},"action":"remove","lines":["Ship"]},{"start":{"row":20,"column":39},"end":{"row":20,"column":49},"action":"insert","lines":["Projectile"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":39},"end":{"row":2,"column":43},"action":"remove","lines":["SHIP"]},{"start":{"row":2,"column":39},"end":{"row":2,"column":40},"action":"insert","lines":["P"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":40},"end":{"row":2,"column":41},"action":"insert","lines":["R"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":41},"end":{"row":2,"column":42},"action":"insert","lines":["O"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":42},"end":{"row":2,"column":43},"action":"insert","lines":["J"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":43},"end":{"row":2,"column":44},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":44},"end":{"row":2,"column":45},"action":"insert","lines":["C"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":45},"end":{"row":2,"column":46},"action":"insert","lines":["T"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":46},"end":{"row":2,"column":47},"action":"insert","lines":["I"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":47},"end":{"row":2,"column":48},"action":"insert","lines":["L"]}]}],[{"group":"doc","deltas":[{"start":{"row":2,"column":48},"end":{"row":2,"column":49},"action":"insert","lines":["E"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":34},"end":{"row":4,"column":38},"action":"remove","lines":["ship"]},{"start":{"row":4,"column":34},"end":{"row":4,"column":35},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":35},"end":{"row":4,"column":36},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":36},"end":{"row":4,"column":37},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":37},"end":{"row":4,"column":38},"action":"insert","lines":["j"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":38},"end":{"row":4,"column":39},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":39},"end":{"row":4,"column":40},"action":"insert","lines":["c"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":40},"end":{"row":4,"column":41},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":41},"end":{"row":4,"column":42},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":42},"end":{"row":4,"column":43},"action":"insert","lines":["l"]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":43},"end":{"row":4,"column":44},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":14,"column":0},"action":"remove","lines":["","    this.meta = {};","    this.skills = {};","    ","    this.isPlayer = false;",""]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":10,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":0},"end":{"row":10,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":0},"end":{"row":35,"column":4},"action":"remove","lines":["","  Projectile.prototype.init = function init(options) {","    !options && (options = {});","","    if (!options.id) {","      throw new Error('No ship id provided!', options);","    }","    ","    INHERITS_FROM && INHERITS_FROM.prototype.init.apply(this, arguments);","","    this.isPlayer = Boolean(options.isPlayer);","","    this.elName = document.createElement('span');","    this.elName.className = 'name';","","    this.el.appendChild(this.elName);","    ","    console.warn('[Projectile|' + this.id + '] Create', this);","  };"]},{"start":{"row":17,"column":0},"end":{"row":18,"column":0},"action":"insert","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":17,"column":0},"end":{"row":18,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":16,"column":3},"end":{"row":17,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":55},"end":{"row":10,"column":23},"action":"remove","lines":["","","    this.init(options);"]}]}],[{"group":"doc","deltas":[{"start":{"row":6,"column":45},"end":{"row":7,"column":0},"action":"insert","lines":["",""]},{"start":{"row":7,"column":0},"end":{"row":7,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":4},"end":{"row":8,"column":0},"action":"insert","lines":["",""]},{"start":{"row":8,"column":0},"end":{"row":8,"column":4},"action":"insert","lines":["    "]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":4},"end":{"row":8,"column":5},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":5},"end":{"row":8,"column":6},"action":"insert","lines":["f"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":6},"end":{"row":8,"column":7},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":7},"end":{"row":8,"column":9},"action":"insert","lines":["()"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":8},"end":{"row":8,"column":10},"action":"insert","lines":["''"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":9},"end":{"row":8,"column":23},"action":"insert","lines":["isBoundToLayer"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":24},"end":{"row":8,"column":25},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":25},"end":{"row":8,"column":26},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":26},"end":{"row":8,"column":27},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":27},"end":{"row":8,"column":28},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":28},"end":{"row":8,"column":29},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":29},"end":{"row":8,"column":30},"action":"insert","lines":["p"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":30},"end":{"row":8,"column":31},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":31},"end":{"row":8,"column":32},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":32},"end":{"row":8,"column":33},"action":"insert","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":33},"end":{"row":8,"column":34},"action":"insert","lines":["n"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":34},"end":{"row":8,"column":35},"action":"insert","lines":["s"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":36},"end":{"row":8,"column":37},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":37},"end":{"row":8,"column":38},"action":"insert","lines":["{"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":38},"end":{"row":10,"column":5},"action":"insert","lines":["","      ","    }"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":6},"end":{"row":9,"column":13},"action":"insert","lines":["options"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":13},"end":{"row":9,"column":14},"action":"insert","lines":["."]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":14},"end":{"row":9,"column":28},"action":"insert","lines":["isBoundToLayer"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":8},"end":{"row":8,"column":9},"action":"insert","lines":["!"]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":9},"end":{"row":8,"column":10},"action":"insert","lines":["("]}]}],[{"group":"doc","deltas":[{"start":{"row":8,"column":38},"end":{"row":8,"column":39},"action":"insert","lines":[")"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":28},"end":{"row":9,"column":29},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":29},"end":{"row":9,"column":30},"action":"insert","lines":["="]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":30},"end":{"row":9,"column":31},"action":"insert","lines":[" "]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":31},"end":{"row":9,"column":32},"action":"insert","lines":["t"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":32},"end":{"row":9,"column":33},"action":"insert","lines":["r"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":33},"end":{"row":9,"column":34},"action":"insert","lines":["u"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":34},"end":{"row":9,"column":35},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":9,"column":35},"end":{"row":9,"column":36},"action":"insert","lines":[";"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":4},"end":{"row":10,"column":5},"action":"remove","lines":["","    if (!('isBoundToLayer' in options)) {","      options.isBoundToLayer = true;","    }"]}]}],[{"group":"doc","deltas":[{"start":{"row":7,"column":4},"end":{"row":8,"column":4},"action":"remove","lines":["","    "]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":0},"end":{"row":3,"column":34},"action":"remove","lines":["    options.isBoundToLayer = true;"]}]}],[{"group":"doc","deltas":[{"start":{"row":3,"column":0},"end":{"row":4,"column":0},"action":"remove","lines":["",""]}]}],[{"group":"doc","deltas":[{"start":{"row":4,"column":39},"end":{"row":4,"column":41},"action":"remove","lines":["50"]},{"start":{"row":4,"column":39},"end":{"row":4,"column":40},"action":"insert","lines":["2"]}]}],[{"group":"doc","deltas":[{"start":{"row":5,"column":41},"end":{"row":5,"column":43},"action":"remove","lines":["50"]},{"start":{"row":5,"column":41},"end":{"row":5,"column":42},"action":"insert","lines":["2"]}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":5,"column":44},"end":{"row":5,"column":44},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1420310315245,"hash":"7d494992fd374c01c3c2acb1d166489c059968b2"}